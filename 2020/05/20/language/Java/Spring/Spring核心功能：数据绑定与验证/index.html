<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Spring 核心功能：数据绑定与验证 - 路由器</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="路由器"><meta name="msapplication-TileImage" content="/img/avatar.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="路由器"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="spring提供了一个数据绑定（DataBinder）与验证（Validator）的设计，目的是不用将验证视为业务逻辑、更易于本地化和可以插入任何可用的验证器"><meta property="og:type" content="blog"><meta property="og:title" content="Spring 核心功能：数据绑定与验证"><meta property="og:url" content="http://example.com/2020/05/20/language/Java/Spring/Spring%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E4%B8%8E%E9%AA%8C%E8%AF%81/"><meta property="og:site_name" content="路由器"><meta property="og:description" content="spring提供了一个数据绑定（DataBinder）与验证（Validator）的设计，目的是不用将验证视为业务逻辑、更易于本地化和可以插入任何可用的验证器"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:published_time" content="2020-05-20T11:32:30.000Z"><meta property="article:modified_time" content="2022-06-27T07:36:07.283Z"><meta property="article:author" content="路由器"><meta property="article:tag" content="Spring核心功能"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2020/05/20/language/Java/Spring/Spring%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E4%B8%8E%E9%AA%8C%E8%AF%81/"},"headline":"Spring 核心功能：数据绑定与验证","image":["http://example.com/img/og_image.png"],"datePublished":"2020-05-20T11:32:30.000Z","dateModified":"2022-06-27T07:36:07.283Z","author":{"@type":"Person","name":"路由器"},"publisher":{"@type":"Organization","name":"路由器","logo":{"@type":"ImageObject","url":"http://example.com/img/avatar.png"}},"description":"spring提供了一个数据绑定（DataBinder）与验证（Validator）的设计，目的是不用将验证视为业务逻辑、更易于本地化和可以插入任何可用的验证器"}</script><link rel="canonical" href="http://example.com/2020/05/20/language/Java/Spring/Spring%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E4%B8%8E%E9%AA%8C%E8%AF%81/"><link rel="icon" href="/img/avatar.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }
          Array
              .from(document.querySelectorAll('.tab-content'))
              .forEach($tab => {
                  $tab.classList.add('is-hidden');
              });
          Array
              .from(document.querySelectorAll('.tabs li'))
              .forEach($tab => {
                  $tab.classList.remove('is-active');
              });
          const $activeTab = document.querySelector(location.hash);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
          const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/avatar.png" alt="路由器" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-05-20T11:32:30.000Z" title="2020/5/20 19:32:30">2020-05-20</time>发表</span><span class="level-item"><time dateTime="2022-06-27T07:36:07.283Z" title="2022/6/27 15:36:07">2022-06-27</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Java/">Java</a><span> / </span><a class="link-muted" href="/categories/Java/Spring/">Spring</a></span><span class="level-item">36 分钟读完 (大约5357个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">Spring 核心功能：数据绑定与验证</h1><div class="content"><p><code>spring</code>提供了一个数据绑定（<code>DataBinder</code>）与验证（<code>Validator</code>）的设计，目的是不用将验证视为业务逻辑、更易于本地化和可以插入任何可用的验证器</p>
<span id="more"></span>

<h2 id="数据验证"><a href="#数据验证" class="headerlink" title="数据验证"></a>数据验证</h2><h3 id="Jakarta-Bean-Validation"><a href="#Jakarta-Bean-Validation" class="headerlink" title="Jakarta Bean Validation"></a>Jakarta Bean Validation</h3><p><code>spring</code>提供对<code>Bean Validation</code>（<code>Jakarta Bean Validation</code>）的支持，它是一个<code>java</code>规范，允许开发人员通过注解或自定义注解来表达对象模型（数据验证）的约束。他的一个被认可的实现是<code>Hibernate Validator</code>，这里使用<code>Hibernate Validator</code>为例</p>
<h4 id="引入依赖"><a href="#引入依赖" class="headerlink" title="引入依赖"></a>引入依赖</h4><p><strong>Maven</strong>：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--hibernate-validator --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.hibernate.validator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hibernate-validator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>7.0.2.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.el<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.el-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.glassfish<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.el<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>Gradle</strong>：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//hibernate-validator</span></span><br><span class="line">implementation <span class="attr">group:</span> <span class="string">&#x27;org.hibernate.validator&#x27;</span>, <span class="attr">name:</span> <span class="string">&#x27;hibernate-validator&#x27;</span>, <span class="attr">version:</span> <span class="string">&#x27;7.0.2.Final&#x27;</span></span><br><span class="line"><span class="comment">//javax.el-api</span></span><br><span class="line">implementation <span class="attr">group:</span> <span class="string">&#x27;javax.el&#x27;</span>, <span class="attr">name:</span> <span class="string">&#x27;javax.el-api&#x27;</span>, <span class="attr">version:</span> <span class="string">&#x27;3.0.0&#x27;</span></span><br><span class="line"><span class="comment">//javax.el</span></span><br><span class="line">implementation <span class="attr">group:</span> <span class="string">&#x27;org.glassfish&#x27;</span>, <span class="attr">name:</span> <span class="string">&#x27;javax.el&#x27;</span>, <span class="attr">version:</span> <span class="string">&#x27;3.0.0&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="声明约束"><a href="#声明约束" class="headerlink" title="声明约束"></a>声明约束</h4><p><code>Hibernate Validator</code> 包含一组基本的常用约束。这些是 Jakarta Bean 验证规范定义的主要约束，此外，<code>Hibernate Validator</code> 提供了有用的自定义约束。每个约束都可以声明<code>message</code>字段值，在验证失败时可以通过方法查看错误值</p>
<h5 id="基本约束"><a href="#基本约束" class="headerlink" title="基本约束"></a>基本约束</h5><table>
<thead>
<tr>
<th>约束名称</th>
<th>作用范围</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>@AssertFalse</td>
<td>布尔</td>
<td>元素为false</td>
</tr>
<tr>
<td>@AssertTrue</td>
<td>布尔</td>
<td>元素为true</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>@DecimalMax(value&#x3D;, inclusive&#x3D;)</td>
<td>数字、字符序列等</td>
<td>元素值小于value，inclusive表示是否带等于</td>
</tr>
<tr>
<td>@DecimalMin(value&#x3D;, inclusive&#x3D;)</td>
<td>数字、字符序列等</td>
<td>元素值大于value，inclusive表示是否带等于</td>
</tr>
<tr>
<td>@Digits(integer&#x3D;, fraction&#x3D;)</td>
<td>数字、字符序列等</td>
<td>值最多为<code>integer</code>位数，和fraction位小数</td>
</tr>
<tr>
<td>@Max(value&#x3D;)</td>
<td>数字、字符序列等</td>
<td>元素值小于等于value</td>
</tr>
<tr>
<td>@Min(value&#x3D;)</td>
<td>数字、字符序列等</td>
<td>元素值大于等于value</td>
</tr>
<tr>
<td>@Negative</td>
<td>数字、字符序列等</td>
<td>元素是否为负</td>
</tr>
<tr>
<td>@NegativeOrZero</td>
<td>数字、字符序列等</td>
<td>元素是否为负或0</td>
</tr>
<tr>
<td>@Positive</td>
<td>数字、字符序列等</td>
<td>元素是否为正</td>
</tr>
<tr>
<td>@PositiveOrZero</td>
<td>数字、字符序列等</td>
<td>元素是否为正或0</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>@Future</td>
<td>日期类型</td>
<td>日期在未来</td>
</tr>
<tr>
<td>@FutureOrPresent</td>
<td>日期类型</td>
<td>日期在现在或未来</td>
</tr>
<tr>
<td>@Past</td>
<td>日期类型</td>
<td>日期在过期</td>
</tr>
<tr>
<td>@PastOrPresent</td>
<td>日期类型</td>
<td>日期在现在或过去</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>@Email</td>
<td>字符序列</td>
<td>检查电子邮箱格式</td>
</tr>
<tr>
<td>@NotBlank</td>
<td>字符序列</td>
<td>元素不为空</td>
</tr>
<tr>
<td>@Pattern(regex&#x3D;, flags&#x3D;)</td>
<td>字符序列</td>
<td>检查是否匹配正则</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>@NotEmpty</td>
<td>Collection、map、字符序列</td>
<td>元素不为空</td>
</tr>
<tr>
<td>@Size(min&#x3D;, max&#x3D;)</td>
<td>Collection、map、字符序列</td>
<td>元素大小介于min、max之间（包含）</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>@NotNull</td>
<td>任意类型</td>
<td>元素值不为null</td>
</tr>
<tr>
<td>@Null</td>
<td>任意类型</td>
<td>元素为null</td>
</tr>
</tbody></table>
<p><strong>说明</strong>：</p>
<ul>
<li>字符序列（<code>CharSequence</code>）是一个接口，他的子类有<code>String</code>、<code>StringBuffer</code>、<code>StringBuilder</code>；</li>
</ul>
<h5 id="附加约束"><a href="#附加约束" class="headerlink" title="附加约束"></a>附加约束</h5><table>
<thead>
<tr>
<th>约束名称</th>
<th>作用范围</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>@Currency(value&#x3D;)</td>
<td>MonetaryAmount</td>
<td>货币单位是否是指定货币单位的一部分</td>
</tr>
<tr>
<td>@DurationMax(days&#x3D;, hours&#x3D;, minutes&#x3D;, seconds&#x3D;, millis&#x3D;, nanos&#x3D;, inclusive&#x3D;)</td>
<td>Duration</td>
<td>元素不大于根据注释参数构造的元素，inclusive代表是否允许相等</td>
</tr>
<tr>
<td>@DurationMin(days&#x3D;, hours&#x3D;, minutes&#x3D;, seconds&#x3D;, millis&#x3D;, nanos&#x3D;, inclusive&#x3D;)</td>
<td>Duration</td>
<td>元素不小于根据注释参数构造的元素，inclusive代表是否允许相等</td>
</tr>
<tr>
<td>@CreditCardNumber(ignoreNonDigitCharacters&#x3D;)</td>
<td>字符序列</td>
<td>检查元素是否通过Luhn 校验和测试</td>
</tr>
<tr>
<td>@EAN</td>
<td>字符序列</td>
<td>检查带注释的字符序列是否为有效的<code>EAN</code>条形码。<code>type</code> 确定条码的类型。默认值为 <code>EAN-13</code></td>
</tr>
<tr>
<td>@ISBN</td>
<td>字符序列</td>
<td>检查带注释的字符序列是否是有效的<code>ISBN</code>。<code>type</code>确定 ISBN 的类型。默认值为 ISBN-13。</td>
</tr>
<tr>
<td>@Length(min&#x3D;, max&#x3D;)</td>
<td>字符序列</td>
<td>元素长度在min和max之间</td>
</tr>
<tr>
<td>@CodePointLength(min&#x3D;, max&#x3D;, normalizationStrategy&#x3D;)</td>
<td>字符序列</td>
<td>字符序列的代码点长度是否介于两者之间<code>min</code>并<code>max</code>包括在内。如果设置，则验证标准化值<code>normalizationStrategy</code></td>
</tr>
<tr>
<td>@LuhnCheck(startIndex&#x3D; , endIndex&#x3D;, checkDigitIndex&#x3D;, ignoreNonDigitCharacters&#x3D;)</td>
<td>字符序列</td>
<td>字符序列中的数字是否通过了 Luhn 校验和算法</td>
</tr>
<tr>
<td>@Mod10Check(multiplier&#x3D;, weight&#x3D;, startIndex&#x3D;, endIndex&#x3D;, checkDigitIndex&#x3D;, ignoreNonDigitCharacters&#x3D;)</td>
<td>字符序列</td>
<td>检查带注释的字符序列中的数字是否通过了通用 mod 10 校验和算法</td>
</tr>
<tr>
<td>@Mod11Check(threshold&#x3D;, startIndex&#x3D;, endIndex&#x3D;, checkDigitIndex&#x3D;, ignoreNonDigitCharacters&#x3D;, treatCheck10As&#x3D;, treatCheck11As&#x3D;)</td>
<td>字符序列</td>
<td>检查带注释的字符序列中的数字是否通过了 mod 11 校验和算法</td>
</tr>
<tr>
<td>@Normalized(form&#x3D;)</td>
<td>字符序列</td>
<td>验证带注释的字符序列是否根据给定的<code>form</code></td>
</tr>
<tr>
<td>@URL(protocol&#x3D;, host&#x3D;, port&#x3D;, regexp&#x3D;, flags&#x3D;)</td>
<td>字符序列</td>
<td>根据 RFC2396 检查带注释的字符序列是否是有效的 URL</td>
</tr>
<tr>
<td>@Range(min&#x3D;, max&#x3D;)</td>
<td>数字、字符序列等</td>
<td>检查注释值是否介于（包括）指定的最小值和最大值之间</td>
</tr>
<tr>
<td>@ScriptAssert(lang&#x3D;, script&#x3D;, alias&#x3D;, reportOn&#x3D;)</td>
<td>任意类型</td>
<td>检查是否可以根据注释元素成功评估给定脚本</td>
</tr>
<tr>
<td>@UniqueElements</td>
<td>Collection</td>
<td>检查带注释的集合是否仅包含唯一元素</td>
</tr>
</tbody></table>
<p><code>Hibernate Validator</code> 还提供了一些<a target="_blank" rel="noopener" href="https://docs.jboss.org/hibernate/validator/7.0/reference/en-US/html_single/#_country_specific_constraints">特定于国家&#x2F;地区的限制条件</a>，例如用于验证社会安全号码，有需要点击查看</p>
<h5 id="约束声明位置"><a href="#约束声明位置" class="headerlink" title="约束声明位置"></a>约束声明位置</h5><ul>
<li><p>字段约束</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NotNull</span></span><br><span class="line"><span class="keyword">private</span> String name;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>getter</code>约束</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NotNull</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getxxx</span><span class="params">()</span> &#123;<span class="keyword">return</span> xxx;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>容器约束</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Set&lt;<span class="meta">@ValidPart</span> String&gt; set = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br></pre></td></tr></table></figure>
</li>
<li><p>类约束</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ValidPassengerCount</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Car</span> &#123;...&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>参数约束</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//name不能为空,可以连续加多个约束，空格分隔</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">funName</span><span class="params">(<span class="meta">@NotNull</span> String name)</span> &#123;...&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>返回值约束</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//返回值不能为null</span></span><br><span class="line"><span class="meta">@NotNull</span></span><br><span class="line"><span class="comment">//返回集合不能包含null</span></span><br><span class="line"><span class="keyword">public</span> List&lt;<span class="meta">@NotNull</span> Customer&gt; funName() &#123;<span class="keyword">return</span> <span class="literal">null</span>;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>级联约束：级联约束需要在将要进行约束的字段标记<code>@Valid</code>即可</p>
</li>
<li><p>约束继承：父类声明的约束在子类也一样有效</p>
</li>
</ul>
<h5 id="验证字段"><a href="#验证字段" class="headerlink" title="验证字段"></a>验证字段</h5><p>验证字段使用<code>Validator</code>类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ValidatorFactory</span> <span class="variable">factory</span> <span class="operator">=</span> Validation.buildDefaultValidatorFactory();</span><br><span class="line"></span><br><span class="line"><span class="type">Validator</span> <span class="variable">validator</span> <span class="operator">=</span> factory.getValidator();</span><br></pre></td></tr></table></figure>

<p><code>Validator</code>方法：</p>
<ul>
<li><p><code>validate()</code>：对给定 bean 的所有约束执行验证</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">validator.validate(person);</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>validateProperty()</code>：验证给定对象的单个命名属性，不能检查级联</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第二个参数是字段名字符串</span></span><br><span class="line">validator.validateProperty(person,<span class="string">&quot;name&quot;</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>validateValue()</code>：给定对象的单个命名属性进行验证，不能检查级联</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">validator.validateValue( person.class,<span class="string">&quot;name&quot;</span>,<span class="literal">null</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="验证方法"><a href="#验证方法" class="headerlink" title="验证方法"></a>验证方法</h5><p>验证方法使用<code>ExecutableValidator</code>类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ValidatorFactory</span> <span class="variable">factory</span> <span class="operator">=</span> Validation.buildDefaultValidatorFactory();</span><br><span class="line"></span><br><span class="line"><span class="type">ExecutableValidator</span> <span class="variable">executableValidator</span> <span class="operator">=</span> factory.getValidator().forExecutables();</span><br></pre></td></tr></table></figure>

<p><code>ExecutableValidator</code>方法：</p>
<ul>
<li><p><code>validateParameters()</code>：验证方法参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Set&lt;ConstraintViolation&lt;Person&gt;&gt; printMessage = executableValidator.validateParameters(</span><br><span class="line">    person,</span><br><span class="line">    Person.class.getMethod(<span class="string">&quot;printMessage&quot;</span>,String.class),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;参数1&quot;</span>&#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>validateReturnValue()</code>：验证方法返回值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Set&lt;ConstraintViolation&lt;Person&gt;&gt; printMessage = executableValidator.validateReturnValue(</span><br><span class="line">    person,</span><br><span class="line">    Person.class.getMethod(<span class="string">&quot;printMessage&quot;</span>,String.class),</span><br><span class="line">    Collections.&lt;Person&gt;emptyList()</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>validateConstructorParameters()</code>：验证构造函数参数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Set&lt;ConstraintViolation&lt;Person&gt;&gt; printMessage = executableValidator.validateParameters(</span><br><span class="line">    Person.class.getConstructor(String.class),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;参数1&quot;</span>&#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>validateConstructorReturnValue()</code>：验证构造函数返回值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">executableValidator.validateConstructorReturnValue(</span><br><span class="line">    Person.class.getConstructor(),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Person</span>()</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="获取验证结果"><a href="#获取验证结果" class="headerlink" title="获取验证结果"></a>获取验证结果</h5><p><code>ConstraintViolation</code>类用于包装验证结果，常用方法如下：</p>
<ul>
<li><code>getMessage()</code>：内插错误消息</li>
<li><code>getMessageTemplate()</code>：非插值错误消息</li>
<li><code>getRootBean()</code>：正在验证的根 bean</li>
<li><code>getRootBeanClass()</code>：正在验证的根 bean类</li>
<li><code>getPropertyPath()</code>：从根 bean 到验证值的属性路径</li>
<li><code>getInvalidValue()</code>：值未能通过约束</li>
<li><code>getConstraintDescriptor()</code>：约束元数据报告失败</li>
<li><code>getExecutableParameters()</code>：验证方法时返回方法或构造函数验证的参数数组</li>
<li><code>getExecutableReturnValue()</code>：验证返回值时提供对验证对象的访问</li>
</ul>
<h4 id="约束示例"><a href="#约束示例" class="headerlink" title="约束示例"></a>约束示例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull(message = &quot;名字不能为空&quot;)</span></span><br><span class="line">    <span class="meta">@Length(min = 1,max = 5,message = &quot;名字长度在1-5之间&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Range(min = 0,max = 150,message = &quot;年龄在0-150之间&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull(message = &quot;生日不能为空&quot;)</span></span><br><span class="line">    <span class="meta">@Past(message = &quot;生日要在过去&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull(message = &quot;邮箱不能为空&quot;)</span></span><br><span class="line">    <span class="meta">@Email(message = &quot;邮箱格式不正确&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//返回值约束</span></span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;返回值不能为空&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFormatPrint</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> String.format(<span class="string">&quot;name=%s,age=%d,birthday=%s&quot;</span>,name,age,birthday);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//参数约束</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">printMessage</span><span class="params">(<span class="meta">@NotBlank(message = &quot;参数不能为空&quot;)</span> String message)</span>&#123;</span><br><span class="line">        System.out.println(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//级联验证</span></span><br><span class="line">    <span class="meta">@Valid</span></span><br><span class="line">    <span class="meta">@NotEmpty</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Cat&gt; cats;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Data</span></span><br><span class="line">    <span class="meta">@NoArgsConstructor</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Cat</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@NotBlank(message = &quot;猫名字不能为空&quot;)</span></span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Cat</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>验证代码</strong> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ValidatorFactory</span> <span class="variable">factory</span> <span class="operator">=</span> Validation.buildDefaultValidatorFactory();</span><br><span class="line"><span class="comment">//字段验证</span></span><br><span class="line"><span class="type">Validator</span> <span class="variable">validator</span> <span class="operator">=</span> factory.getValidator();</span><br><span class="line"><span class="comment">//方法验证</span></span><br><span class="line"><span class="type">ExecutableValidator</span> <span class="variable">executableValidator</span> <span class="operator">=</span> factory.getValidator().forExecutables();</span><br><span class="line"></span><br><span class="line"><span class="comment">//构造bean</span></span><br><span class="line"><span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"><span class="comment">//名字长度大于5</span></span><br><span class="line">person.setName(<span class="string">&quot;克里斯蒂安刘能&quot;</span>);</span><br><span class="line"><span class="comment">//不给猫加名字</span></span><br><span class="line">person.setCats(Collections.singletonList(<span class="keyword">new</span> <span class="title class_">Person</span>.Cat()));</span><br><span class="line"></span><br><span class="line"><span class="comment">//验证字段</span></span><br><span class="line">Set&lt;ConstraintViolation&lt;Person&gt;&gt; constraintViolationSet = validator.validate(person);</span><br><span class="line"><span class="keyword">for</span> (ConstraintViolation&lt;Person&gt; constraintViolation : constraintViolationSet) &#123;</span><br><span class="line">    System.out.println(constraintViolation.getMessage());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//验证方法</span></span><br><span class="line">Set&lt;ConstraintViolation&lt;Person&gt;&gt; printMessage = executableValidator.validateParameters(</span><br><span class="line">    person,</span><br><span class="line">    Person.class.getMethod(<span class="string">&quot;printMessage&quot;</span>,String.class),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;&quot;</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (ConstraintViolation&lt;Person&gt; constraintViolation : printMessage) &#123;</span><br><span class="line">    System.out.println(constraintViolation.getMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="自定义约束"><a href="#自定义约束" class="headerlink" title="自定义约束"></a>自定义约束</h4><h5 id="创建约束注释"><a href="#创建约束注释" class="headerlink" title="创建约束注释"></a>创建约束注释</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.FIELD&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Constraint(validatedBy = &#123;MyConstraintValidator.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyCheck &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//违反约束的默认消息</span></span><br><span class="line">    String <span class="title function_">message</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;字符串值必须为yes&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//此约束所属的验证组的属性</span></span><br><span class="line">    Class&lt;?&gt;[] groups() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Jakarta Bean Validation API 的客户端可以使用该属性将自定义有效负载对象分配给约束</span></span><br><span class="line">    Class&lt;? <span class="keyword">extends</span> <span class="title class_">Payload</span>&gt;[] payload() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//允许指定所需的案例模式,一般不需要</span></span><br><span class="line">    String[] value() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="实现一个验证器"><a href="#实现一个验证器" class="headerlink" title="实现一个验证器"></a>实现一个验证器</h5><p>实现<code>ConstraintValidator&lt;A extends Annotation, T&gt;</code> 接口并实现其方法即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 父类泛型解释</span></span><br><span class="line"><span class="comment"> * A extends Annotation：这里是MyCheck，表示要验证的注释类型</span></span><br><span class="line"><span class="comment"> * T：这里是String，表示要处理的元素类型</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConstraintValidator</span> <span class="keyword">implements</span> <span class="title class_">ConstraintValidator</span>&lt;MyCheck, String&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//访问当前验证注解的属性值</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MyCheck constraintAnnotation)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//包含实际的验证逻辑</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isValid</span><span class="params">(String s, ConstraintValidatorContext constraintValidatorContext)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;yes&quot;</span>.equals(s))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来只需要把注解放到想要验证的地方就可以了，此处不演示</p>
<h3 id="验证单个对象（spring）"><a href="#验证单个对象（spring）" class="headerlink" title="验证单个对象（spring）"></a>验证单个对象（spring）</h3><p><code>spring</code>提供了<code>Validator</code>接口，可以创建一个验证类实现该接口，并实现其中的方法，用于数据的验证</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//getters/setters</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonValidator</span> <span class="keyword">implements</span> <span class="title class_">Validator</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Validator是否可以提供验证该clazz类的实例</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> clazz</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">supports</span><span class="params">(Class&lt;?&gt; clazz)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Person.class.equals(clazz);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证给定的对象，并将错误信息返稿errors里</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> target 验证码目标对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> errors 包装错误信息，内部包括target对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">validate</span><span class="params">(Object target, Errors errors)</span> &#123;</span><br><span class="line">        <span class="comment">//拒绝该属性</span></span><br><span class="line">        ValidationUtils.rejectIfEmpty(errors, <span class="string">&quot;name&quot;</span>, <span class="string">&quot;name为空&quot;</span>);</span><br><span class="line">        <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> (Person) target;</span><br><span class="line">        <span class="keyword">if</span> (p.getAge() &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            errors.rejectValue(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;年龄为负数&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (p.getAge() &gt; <span class="number">110</span>) &#123;</span><br><span class="line">            errors.rejectValue(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;年纪过大&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>说明</strong>：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/docs/6.0.0-SNAPSHOT/javadoc-api/org/springframework/validation/ValidationUtils.html">ValidationUtils</a>是<code>spring</code>提供的工具类；</li>
<li>拒绝字段时除了自定义的拒绝code（例如<code>rejectValue(&quot;age&quot;, &quot;too.darn.old&quot;)</code>），还会自动注册其他code（还会注册<code>too.darn.old.ageand too.darn.old.age.int</code>）；</li>
</ul>
<p>上述代码可通过如下代码调用验证和获取结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">person.setName(<span class="string">&quot;张三&quot;</span>);</span><br><span class="line"><span class="type">DataBinder</span> <span class="variable">binder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataBinder</span>(person);</span><br><span class="line">binder.setValidator(<span class="keyword">new</span> <span class="title class_">PersonValidator</span>());</span><br><span class="line">binder.validate();</span><br><span class="line"><span class="type">BindingResult</span> <span class="variable">results</span> <span class="operator">=</span> binder.getBindingResult();</span><br><span class="line">System.out.println(results);</span><br></pre></td></tr></table></figure>



<h3 id="验证嵌套对象（spring）"><a href="#验证嵌套对象（spring）" class="headerlink" title="验证嵌套对象（spring）"></a>验证嵌套对象（spring）</h3><p>验证嵌套对象时最好将每个对象的验证逻辑封装在自己的<code>Validator</code>实现中。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//getters/setters</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cat</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//getters/setters</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CatValidator</span> <span class="keyword">implements</span> <span class="title class_">Validator</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">supports</span><span class="params">(Class&lt;?&gt; clazz)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Cat.class.equals(clazz);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">validate</span><span class="params">(Object target, Errors errors)</span> &#123;</span><br><span class="line">        ValidationUtils.rejectIfEmptyOrWhitespace(errors,<span class="string">&quot;cat.name&quot;</span>,<span class="string">&quot;没名字&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonValidator</span> <span class="keyword">implements</span> <span class="title class_">Validator</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> CatValidator catValidator;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">PersonValidator</span><span class="params">(CatValidator catValidator)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.catValidator = catValidator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Validator是否可以提供验证该clazz类的实例</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> clazz</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">supports</span><span class="params">(Class&lt;?&gt; clazz)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Person.class.equals(clazz);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证给定的对象，并将错误信息返稿errors里</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> target 验证码目标对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> errors 包装错误信息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">validate</span><span class="params">(Object target, Errors errors)</span> &#123;</span><br><span class="line">        ValidationUtils.rejectIfEmpty(errors, <span class="string">&quot;name&quot;</span>, <span class="string">&quot;name为空&quot;</span>);</span><br><span class="line">        <span class="type">Person</span> <span class="variable">p</span> <span class="operator">=</span> (Person) target;</span><br><span class="line">        <span class="comment">//去执行cat的验证</span></span><br><span class="line">        ValidationUtils.invokeValidator(<span class="built_in">this</span>.catValidator,p.getCat(),errors);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="数据绑定"><a href="#数据绑定" class="headerlink" title="数据绑定"></a>数据绑定</h2><h3 id="DataBinder"><a href="#DataBinder" class="headerlink" title="DataBinder"></a>DataBinder</h3><p><code>DataBinder</code>是<code>spring</code>提供的数据绑定机制，可以与<code>Validator</code>接口的实现类配合使用，进行数据验证，用法如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">person.setName(<span class="string">&quot;张三&quot;</span>);</span><br><span class="line"><span class="type">DataBinder</span> <span class="variable">binder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataBinder</span>(person);</span><br><span class="line">binder.setValidator(<span class="keyword">new</span> <span class="title class_">PersonValidator</span>());</span><br><span class="line"><span class="comment">//执行验证</span></span><br><span class="line">binder.validate();</span><br><span class="line"><span class="comment">//获取错误信息</span></span><br><span class="line"><span class="type">BindingResult</span> <span class="variable">results</span> <span class="operator">=</span> binder.getBindingResult();</span><br><span class="line">System.out.println(results);</span><br></pre></td></tr></table></figure>



<h3 id="BeanWrapper-接口"><a href="#BeanWrapper-接口" class="headerlink" title="BeanWrapper 接口"></a>BeanWrapper 接口</h3><p><code>BeanWrapper</code>接口以及其对应实现（<code>BeanWrapperImpl</code>）位于<code>org.springframework.beans</code>包内。<code>BeanWrapper</code>提供了设置和获取属性值、获取属性描述符和查询属性以确定他们是可读还是可写的功能。此外<code>BeanWrapper</code>还提供对嵌套属性的支持，还有对设置索引属性的支持。<code>BeanWrapper</code>会在<code>DataBinder</code>和<code>BeanFactory</code>中被使用</p>
<table>
<thead>
<tr>
<th>表达式</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>属性名</td>
</tr>
<tr>
<td>cat.name</td>
<td>嵌套属性</td>
</tr>
<tr>
<td>list[1]</td>
<td>集合属性</td>
</tr>
<tr>
<td>map[key]</td>
<td>键值对映射</td>
</tr>
</tbody></table>
<p><strong>举例如下</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cat</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">BeanWrapperImpl</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BeanWrapperImpl</span>(<span class="keyword">new</span> <span class="title class_">Person</span>());</span><br><span class="line"><span class="comment">//设置值（方式一）</span></span><br><span class="line">person.setPropertyValue(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;张三&quot;</span>);</span><br><span class="line"><span class="comment">//设置值（方式二）</span></span><br><span class="line"><span class="type">PropertyValue</span> <span class="variable">value</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PropertyValue</span>(<span class="string">&quot;cat&quot;</span>, <span class="keyword">new</span> <span class="title class_">Cat</span>());</span><br><span class="line">person.setPropertyValue(value);</span><br><span class="line"><span class="comment">//设置嵌套属性</span></span><br><span class="line">person.setPropertyValue(<span class="string">&quot;cat.name&quot;</span>,<span class="string">&quot;猫咪&quot;</span>);</span><br><span class="line"><span class="comment">//获取person对象</span></span><br><span class="line"><span class="type">Person</span> <span class="variable">rootInstance</span> <span class="operator">=</span> (Person)person.getRootInstance();</span><br><span class="line"></span><br><span class="line">System.out.println(rootInstance);</span><br></pre></td></tr></table></figure>



<h3 id="PropertyEditor-接口"><a href="#PropertyEditor-接口" class="headerlink" title="PropertyEditor 接口"></a>PropertyEditor 接口</h3><p><code>Spring</code>内部使用<code>PropertyEditor</code>接口进行属性编辑，将这些字符串装换为对应的<code>Object</code>类型。比如使用<code>xml</code>声明<code>bean</code>属性时，spring就会尝试使用<code>ClassEditor</code>将参数解析为<code>Class</code>对象。如果需要在绑定属性时做自定义操作，可以自己实现<code>PropertyEditor</code>并注册到<code>ioc</code>容器中</p>
<h4 id="内置-PropertyEditor-实现"><a href="#内置-PropertyEditor-实现" class="headerlink" title="内置 PropertyEditor 实现"></a>内置 PropertyEditor 实现</h4><p><code>spring</code>内置了很多<code>PropertyEditor</code>的实现，<code>BeanFactory</code>和<code>ApplicationContext</code>都会通过他们来使用<code>BeanWrapper</code>进行属性转换。他们都位于<code>org.springframework.beans.propertyeditors</code>包中，并且大多数由<code>PropertyEditor</code> 注册</p>
<ul>
<li><code>ByteArrayPropertyEditor</code>：将字符串转换为对应的字节表示</li>
<li><code>ClassEditor</code>：将表示类的字符串解析为实际类</li>
<li><code>CustomBooleanEditor</code>：可自定义的Boolean编辑器</li>
<li><code>CustomCollectionEditor</code>：将任意原集合转换为目标集合类型</li>
<li><code>CustomDateEditor</code>：自定义<code>DateFormat</code>，默认未注册</li>
<li><code>CustomNumberEditor</code>：处理数字类型</li>
<li><code>FileEditor</code>：将字符串解析为<code>java.io.File</code>对象</li>
<li><code>InputStreamEditor</code>：将字符串转换为<code>InputStream</code></li>
<li><code>LocaleEditor</code>：将字符串（格式<code>[language]_[country]_[variant]</code>）转换为<code>Locale</code>对象，反之亦然</li>
<li><code>PatternEditor</code>：字符串解析为<code>java.util.regex.Pattern</code>对象，反之亦然</li>
<li><code>PropertiesEditor</code>：将字符串转换为<code>Properties</code>对象</li>
<li><code>StringTrimmerEditor</code>：修剪字符串的属性编辑器。可选地允许将空字符串转换为<code>null</code>值，默认未注册</li>
<li><code>URLEditor</code>：将<code>url</code>字符串转化为<code>url</code>对象</li>
</ul>
<h4 id="自定义-PropertyEditor"><a href="#自定义-PropertyEditor" class="headerlink" title="自定义 PropertyEditor"></a>自定义 PropertyEditor</h4><p>自定义 <code>PropertyEditor</code>可以通过属性注入时的字符串<code>value</code>值创建自己希望的实例，然后注入到<code>bean</code>中。</p>
<p><code>bean</code>类如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cat</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Cat</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将<code>Cat</code>注入到<code>Person</code>中</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注入属性--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;test.anno.Person&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--此时使用的是value--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cat&quot;</span> <span class="attr">value</span>=<span class="string">&quot;猫名字&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>自定义<code>Cat</code>类型的编辑器<code>CatTypeEditor</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CatTypeEditor</span> <span class="keyword">extends</span> <span class="title class_">PropertyEditorSupport</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAsText</span><span class="params">(String text)</span> <span class="keyword">throws</span> IllegalArgumentException &#123;</span><br><span class="line">        <span class="built_in">super</span>.setValue(<span class="keyword">new</span> <span class="title class_">Cat</span>(text));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过<code>xml</code>文件配置属性的映射关系并注册进<code>ioc</code>容器中</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.beans.factory.config.CustomEditorConfigurer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;customEditors&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--配置类型和编辑器的映射--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;test.anno.Cat&quot;</span> <span class="attr">value</span>=<span class="string">&quot;test.anno.CatTypeEditor&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>也可以通过实现<code>PropertyEditorRegistrar</code>接口进行注册</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//这里直接使用注解注入了，使用xml也一样</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomPropertyEditorRegistrar</span> <span class="keyword">implements</span> <span class="title class_">PropertyEditorRegistrar</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerCustomEditors</span><span class="params">(PropertyEditorRegistry propertyEditorRegistry)</span> &#123;</span><br><span class="line">        propertyEditorRegistry.registerCustomEditor(Cat.class,<span class="keyword">new</span> <span class="title class_">CatTypeEditor</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>xml</code>文件中配置注册器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.beans.factory.config.CustomEditorConfigurer&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注册自定义注册器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;propertyEditorRegistrars&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;customPropertyEditorRegistrar&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h2><p><code>spring 3</code>引入了一个<code>core.convert</code>的包，用于提供通用的类型转换。它可以用来替代自定义 <code>PropertyEditor</code>，将外部的字符串<code>value</code>值转化为所需的属性类型</p>
<h3 id="自定义转换器"><a href="#自定义转换器" class="headerlink" title="自定义转换器"></a>自定义转换器</h3><p>创建转换器类，实现<code>Converter</code>接口，实现<code>convert</code>方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Converter</span>&lt;S, T&gt; &#123;</span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    T <span class="title function_">convert</span><span class="params">(S source)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span> &lt;U&gt; Converter&lt;S, U&gt; <span class="title function_">andThen</span><span class="params">(Converter&lt;? <span class="built_in">super</span> T, ? extends U&gt; after)</span> &#123;</span><br><span class="line">        Assert.notNull(after, <span class="string">&quot;After Converter must not be null&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> (s) -&gt; &#123;</span><br><span class="line">            <span class="type">T</span> <span class="variable">initialResult</span> <span class="operator">=</span> <span class="built_in">this</span>.convert(s);</span><br><span class="line">            <span class="keyword">return</span> initialResult != <span class="literal">null</span> ? after.convert(initialResult) : <span class="literal">null</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>泛型<code>S</code>、<code>T</code>表示将数据从<code>S</code>类型转换为<code>T</code>类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringToCatConverter</span> <span class="keyword">implements</span> <span class="title class_">Converter</span>&lt;String,Cat&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Cat <span class="title function_">convert</span><span class="params">(String source)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Cat</span>(source);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="自定义转换器工厂"><a href="#自定义转换器工厂" class="headerlink" title="自定义转换器工厂"></a>自定义转换器工厂</h3><p>当需要集中定义将字符串转化为有公共接口的多个类时，应该实现<code>ConverterFactory</code>接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ConverterFactory</span>&lt;S, R&gt; &#123;</span><br><span class="line">    &lt;T <span class="keyword">extends</span> <span class="title class_">R</span>&gt; Converter&lt;S, T&gt; <span class="title function_">getConverter</span><span class="params">(Class&lt;T&gt; targetType)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中泛型表示将<code>S</code>转换为<code>T</code>类型，<code>T</code>必须是<code>R</code>的子类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringToAnimalConverterFactor</span> <span class="keyword">implements</span> <span class="title class_">ConverterFactory</span>&lt;String,Animal&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T <span class="keyword">extends</span> <span class="title class_">Animal</span>&gt; Converter&lt;String, T&gt; <span class="title function_">getConverter</span><span class="params">(Class&lt;T&gt; targetType)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据不同的T类型创建不同的转换器，T可能是Cat也可能时Dog都实现了Animal</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">StringToAnimalConverter</span>&lt;T <span class="keyword">extends</span> <span class="title class_">Animal</span>&gt; <span class="keyword">implements</span> <span class="title class_">Converter</span>&lt;String, T&gt; &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> Class&lt;T&gt; AnimalType;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">StringToAnimalConverter</span><span class="params">(Class&lt;T&gt; AnimalType)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.AnimalType = AnimalType;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@SneakyThrows</span></span><br><span class="line">        <span class="keyword">public</span> T <span class="title function_">convert</span><span class="params">(String source)</span> &#123;</span><br><span class="line">            <span class="type">Animal</span> <span class="variable">a</span> <span class="operator">=</span> (Animal)AnimalType.newInstance();</span><br><span class="line">            a.setName(source);</span><br><span class="line">            <span class="keyword">return</span> (T)a;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用反射效率低，个人觉得还是每个目标类型都定义一个转换器比较好，如下所示</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">StringToAnimalConverter</span>&lt;T&gt; <span class="keyword">implements</span> <span class="title class_">Converter</span>&lt;String, Cat&gt; &#123;</span><br><span class="line">        <span class="keyword">public</span> Cat <span class="title function_">convert</span><span class="params">(String source)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Cat</span>(<span class="string">&quot;猫名字&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="多对源类型与目标类型转换"><a href="#多对源类型与目标类型转换" class="headerlink" title="多对源类型与目标类型转换"></a>多对源类型与目标类型转换</h3><p><code>GenericConverter</code>提供多对源类型和目标类型之间进行转换。它提供了可用的源和目标字段的上下文，可以在实现逻辑时使用。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">GenericConverter</span> &#123;</span><br><span class="line">    <span class="comment">//返回支持的源→目标类型对</span></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    Set&lt;GenericConverter.ConvertiblePair&gt; getConvertibleTypes();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//类型转换方法</span></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    Object <span class="title function_">convert</span><span class="params">(<span class="meta">@Nullable</span> Object source, TypeDescriptor sourceType, TypeDescriptor targetType)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//元-&gt;目标类型对</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">ConvertiblePair</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> Class&lt;?&gt; sourceType;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> Class&lt;?&gt; targetType;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ConvertiblePair</span><span class="params">(Class&lt;?&gt; sourceType, Class&lt;?&gt; targetType)</span> &#123;</span><br><span class="line">            Assert.notNull(sourceType, <span class="string">&quot;Source type must not be null&quot;</span>);</span><br><span class="line">            Assert.notNull(targetType, <span class="string">&quot;Target type must not be null&quot;</span>);</span><br><span class="line">            <span class="built_in">this</span>.sourceType = sourceType;</span><br><span class="line">            <span class="built_in">this</span>.targetType = targetType;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Class&lt;?&gt; getSourceType() &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.sourceType;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Class&lt;?&gt; getTargetType() &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.targetType;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//equals()/hashCode()/toString()</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此接口一般只有在非常复杂的情况下才会使用</p>
<h3 id="类型转换条件"><a href="#类型转换条件" class="headerlink" title="类型转换条件"></a>类型转换条件</h3><p>通过<code>ConditionalGenericConverter</code>接口可以定义类型转换条件。比如希望在目标字段上存在特定注解时才进行转换，或者时在目标类型上定义了特定方法才进行转换</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ConditionalConverter</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">matches</span><span class="params">(TypeDescriptor sourceType, TypeDescriptor targetType)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ConditionalGenericConverter</span> <span class="keyword">extends</span> <span class="title class_">GenericConverter</span>, ConditionalConverter &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>举例如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringToCatConditionalGenericConverter</span> <span class="keyword">implements</span> <span class="title class_">ConditionalGenericConverter</span> &#123;</span><br><span class="line">    <span class="comment">//转换条件</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">matches</span><span class="params">(TypeDescriptor sourceType, TypeDescriptor targetType)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//可以转换的源类型-目标类型对</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;ConvertiblePair&gt; <span class="title function_">getConvertibleTypes</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//转换方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">convert</span><span class="params">(Object source, TypeDescriptor sourceType, TypeDescriptor targetType)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="通用类型转换逻辑"><a href="#通用类型转换逻辑" class="headerlink" title="通用类型转换逻辑"></a>通用类型转换逻辑</h3><p><code>ConversionService</code>接口定义了一个统一的<code>api</code>，用于在运行时执行类型转换逻辑</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ConversionService</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">canConvert</span><span class="params">(<span class="meta">@Nullable</span> Class&lt;?&gt; sourceType, Class&lt;?&gt; targetType)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">canConvert</span><span class="params">(<span class="meta">@Nullable</span> TypeDescriptor sourceType, TypeDescriptor targetType)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    &lt;T&gt; T <span class="title function_">convert</span><span class="params">(<span class="meta">@Nullable</span> Object source, Class&lt;T&gt; targetType)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    Object <span class="title function_">convert</span><span class="params">(<span class="meta">@Nullable</span> Object source, <span class="meta">@Nullable</span> TypeDescriptor sourceType, TypeDescriptor targetType)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>GenericConversionService</code>类和<code>ConversionServiceFactory</code>类是<code>ConversionService</code>的实现类，特们提供了大多数环境的通用实现，默认可以在字符串、数字、枚举、集合、映射和其他常见类型之间进行转换。如果想用自定义转换器进行补充，只需要补充或覆盖默认转换器，配置如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;conversionService&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.springframework.context.support.ConversionServiceFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;converters&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;example.MyCustomConverter&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h2 id="字段格式"><a href="#字段格式" class="headerlink" title="字段格式"></a>字段格式</h2><h3 id="Formatter-接口"><a href="#Formatter-接口" class="headerlink" title="Formatter 接口"></a>Formatter 接口</h3><p><code>Formatter</code> 接口提供了简单的字段格式化功能</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Formatter</span>&lt;T&gt; <span class="keyword">extends</span> <span class="title class_">Printer</span>&lt;T&gt;, Parser&lt;T&gt; &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Printer</span>&lt;T&gt; &#123;</span><br><span class="line">    String <span class="title function_">print</span><span class="params">(T object, Locale locale)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Parser</span>&lt;T&gt; &#123;</span><br><span class="line">    T <span class="title function_">parse</span><span class="params">(String text, Locale locale)</span> <span class="keyword">throws</span> ParseException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>自定义格式转换，需要实现<code>Formatter</code>接口，实现其中的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyDateFormatter</span> <span class="keyword">implements</span> <span class="title class_">Formatter</span>&lt;Date&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//时间格式</span></span><br><span class="line">    <span class="keyword">private</span> String pattern;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyDateFormatter</span><span class="params">(String pattern)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.pattern = pattern;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyDateFormatter</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.pattern = <span class="string">&quot;yyyy-MM--dd&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//解析方法，将字符串转化为对应的类型</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">parse</span><span class="params">(String formatted, Locale locale)</span> <span class="keyword">throws</span> ParseException &#123;</span><br><span class="line">        <span class="keyword">return</span> getDateFormat(locale).parse(formatted);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//输出方法，将对象转换为对应格式的字符串</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">print</span><span class="params">(Date date, Locale locale)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getDateFormat(locale).format(date);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> DateFormat <span class="title function_">getDateFormat</span><span class="params">(Locale locale)</span> &#123;</span><br><span class="line">        <span class="type">DateFormat</span> <span class="variable">dateFormat</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="built_in">this</span>.pattern, locale);</span><br><span class="line">        dateFormat.setLenient(<span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">return</span> dateFormat;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过<code>FormattingConversionServiceFactoryBean</code>注册到<code>ioc</code>容器中</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;conversionService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.format.support.FormattingConversionServiceFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;registerDefaultFormatters&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--自定义的formatter加入到该属性结合中--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;formatters&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;test.anno.MyDateFormatter&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>也可以通过<code>java</code>代码形式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> FormattingConversionService <span class="title function_">conversionService</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">DefaultFormattingConversionService</span> <span class="variable">conversionService</span> <span class="operator">=</span> </span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">DefaultFormattingConversionService</span>(<span class="literal">false</span>);</span><br><span class="line">    </span><br><span class="line">    conversionService.addFormatter(<span class="keyword">new</span> <span class="title class_">MyDateFormatter</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> conversionService;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过以下格式注入会调用自定义的<code>MyDateFormatter</code>类的<code>parse</code>方法进行转换</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注入属性--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;test.anno.Person&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;birthday&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2000-3--2&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="注解格式转换"><a href="#注解格式转换" class="headerlink" title="注解格式转换"></a>注解格式转换</h3><p>字段格式可以通过字段类型和注解进行配置，想要将注解绑定到<code>Formatter</code>，需要实现<code>AnnotationFormatterFactory</code>接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//A是一个注解类型，用来修饰与格式化逻辑的相关字段</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AnnotationFormatterFactory</span>&lt;A <span class="keyword">extends</span> <span class="title class_">Annotation</span>&gt; &#123;</span><br><span class="line">    <span class="comment">//返回能使用注解的字段类型</span></span><br><span class="line">    Set&lt;Class&lt;?&gt;&gt; getFieldTypes();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//返回一个Printer打印注解字段的值</span></span><br><span class="line">    Printer&lt;?&gt; getPrinter(A annotation, Class&lt;?&gt; fieldType);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//返回一个Parser用来解析注解字段的值</span></span><br><span class="line">    Parser&lt;?&gt; getParser(A annotation, Class&lt;?&gt; fieldType);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>自定义注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.METHOD, ElementType.FIELD, ElementType.PARAMETER, ElementType.ANNOTATION_TYPE&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyDateFormat &#123;</span><br><span class="line"></span><br><span class="line">    MyDateFormat.Style <span class="title function_">style</span><span class="params">()</span> <span class="keyword">default</span> MyDateFormat.Style.DEFAULT;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//时间格式化类型</span></span><br><span class="line">    String <span class="title function_">pattern</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//默认为英文格式</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">enum</span> <span class="title class_">Style</span> &#123;</span><br><span class="line">        DEFAULT,</span><br><span class="line">        CHINESE;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="title function_">Style</span><span class="params">()</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现<code>AnnotationFormatterFactory</code>接口并实现抽象方法，将需要使用的注解作为其泛型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父类传递的泛型为MyDateFormat</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyDateFormatAnnotationFormatterFactory</span> <span class="keyword">implements</span> <span class="title class_">AnnotationFormatterFactory</span>&lt;MyDateFormat&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Set&lt;Class&lt;?&gt;&gt; Types;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        Set&lt;Class&lt;?&gt;&gt; fieldTypes = <span class="keyword">new</span> <span class="title class_">HashSet</span>(<span class="number">8</span>);</span><br><span class="line">        fieldTypes.add(Date.class);</span><br><span class="line">        Types = Collections.unmodifiableSet(fieldTypes);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyDateFormatAnnotationFormatterFactory</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//返回可以解析的类集合</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Set&lt;Class&lt;?&gt;&gt; getFieldTypes() &#123;</span><br><span class="line">        <span class="keyword">return</span> Types;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取打印器</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Printer&lt;?&gt; getPrinter(MyDateFormat annotation, Class&lt;?&gt; fieldType) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.configureFormatterFrom(annotation);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取解析器</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Parser&lt;?&gt; getParser(MyDateFormat annotation, Class&lt;?&gt; fieldType) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.configureFormatterFrom(annotation);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//这里获取打印器和解析器是上一小节自定义的Formatter类</span></span><br><span class="line">    <span class="comment">//也可以直接返回SimpleDateFormat值?</span></span><br><span class="line">    <span class="keyword">private</span> Formatter&lt;Date&gt; <span class="title function_">configureFormatterFrom</span><span class="params">(MyDateFormat annotation)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">pattern</span> <span class="operator">=</span> annotation.pattern();</span><br><span class="line">        <span class="comment">//如果制定了时间格式</span></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.hasLength(pattern)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyDateFormatter</span>(pattern);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            MyDateFormat.<span class="type">Style</span> <span class="variable">style</span> <span class="operator">=</span> annotation.style();</span><br><span class="line">            <span class="keyword">if</span> (style == MyDateFormat.Style.CHINESE) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyDateFormatter</span>(<span class="string">&quot;yyyy年MM月dd日 HH点mm分ss秒&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyDateFormatter</span>(<span class="string">&quot;yyyy:MM:dd HH:mm:ss&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>创建注册器，用于同一添加</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyDateFormatterRegistrar</span> <span class="keyword">implements</span> <span class="title class_">FormatterRegistrar</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> MyDateFormatter myDateFormatter;</span><br><span class="line">    <span class="keyword">private</span> MyDateFormatAnnotationFormatterFactory myDateFormatAnnotationFormatterFactory;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyDateFormatterRegistrar</span><span class="params">()</span> &#123;</span><br><span class="line">        myDateFormatter = <span class="keyword">new</span> <span class="title class_">MyDateFormatter</span>();</span><br><span class="line">        myDateFormatAnnotationFormatterFactory = <span class="keyword">new</span> <span class="title class_">MyDateFormatAnnotationFormatterFactory</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerFormatters</span><span class="params">(FormatterRegistry registry)</span> &#123;</span><br><span class="line">        registry.addFormatter(myDateFormatter);</span><br><span class="line">        <span class="comment">//添加myDateFormatter，其实这里不添加也可以</span></span><br><span class="line">        registry.addFormatterForFieldType(Date.class,myDateFormatter);</span><br><span class="line">        <span class="comment">//添加myDateFormatAnnotationFormatterFactory</span></span><br><span class="line">        registry.addFormatterForFieldAnnotation(myDateFormatAnnotationFormatterFactory);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>和上一小节一样，通过<code>FormattingConversionServiceFactoryBean</code>注册进<code>ioc</code>容器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;conversionService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.format.support.FormattingConversionServiceFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;registerDefaultFormatters&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--将自定义的formatterRegistrar注入到该属性集合中--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;formatterRegistrars&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;test.anno.MyDateFormatterRegistrar&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>或者也可以通过<code>java</code>代码配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> FormattingConversionService <span class="title function_">conversionService</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">DefaultFormattingConversionService</span> <span class="variable">conversionService</span> <span class="operator">=</span> </span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">DefaultFormattingConversionService</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">MyDateFormatterRegistrar</span> <span class="variable">registrar</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyDateFormatterRegistrar</span>();</span><br><span class="line">    registrar.registerFormatters(conversionService);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> conversionService;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来只需要在需要用到的地方加上自定义的<code>@MyDateFormat</code>注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MyDateFormat</span></span><br><span class="line"><span class="keyword">private</span> Date Birthday;</span><br></pre></td></tr></table></figure>

<p>然后在注入属性时就会自动调用<code>MyDateFormatAnnotationFormatterFactory</code>类的<code>getParser</code>方法获取解析器，然后进行解析了</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注入属性--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;person&quot;</span> <span class="attr">class</span>=<span class="string">&quot;test.anno.Person&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;birthday&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2000:7:7 7:7:7&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>





</div><div class="article-licensing box"><div class="licensing-title"><p>Spring 核心功能：数据绑定与验证</p><p><a href="http://example.com/2020/05/20/language/Java/Spring/Spring核心功能：数据绑定与验证/">http://example.com/2020/05/20/language/Java/Spring/Spring核心功能：数据绑定与验证/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>路由器</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2020-05-20</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2022-06-27</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Spring%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD/">Spring核心功能</a></div></article></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/06/01/language/Java/Spring/Spring%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%EF%BC%9A%E6%95%B0%E6%8D%AE%E7%BC%93%E5%86%B2%E5%99%A8%E5%92%8C%E7%BC%96%E8%A7%A3%E7%A0%81%E5%99%A8/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Spring 核心功能：数据缓冲器和编解码器</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/03/28/language/Java/Spring/Spring%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD%EF%BC%9ASpring%20%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%AD%E8%A8%80%EF%BC%88SpEL%EF%BC%89/"><span class="level-item">Spring 核心功能：Spring 表达式语言（SpEL）</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="路由器"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">路由器</p><p class="is-size-6 is-block">笔记</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>M78</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">33</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">13</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">15</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/zcy626727" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/zcy626727"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">23</span></span></a><ul><li><a class="level is-mobile" href="/categories/Java/Spring/"><span class="level-start"><span class="level-item">Spring</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Java/Spring-Boot/"><span class="level-start"><span class="level-item">Spring Boot</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/Java/Spring-Boots/"><span class="level-start"><span class="level-item">Spring Boots</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Java/Spring-MVC/"><span class="level-start"><span class="level-item">Spring MVC</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Kubernetes/"><span class="level-start"><span class="level-item">Kubernetes</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/categories/Linux/Fedora/"><span class="level-start"><span class="level-item">Fedora</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/Ubuntu/"><span class="level-start"><span class="level-item">Ubuntu</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/Python/"><span class="level-start"><span class="level-item">Python</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/Python/Scrapy/"><span class="level-start"><span class="level-item">Scrapy</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="level-start"><span class="level-item">数据库</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/"><span class="level-start"><span class="level-item">Redis</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-09-17T05:18:16.000Z">2022-09-17</time></p><p class="title"><a href="/2022/09/17/tools/Kubernetes/Kubernetes%E9%83%A8%E7%BD%B2/">Kubernetes 部署</a></p><p class="categories"><a href="/categories/Kubernetes/">Kubernetes</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-06-25T14:54:00.000Z">2022-06-25</time></p><p class="title"><a href="/2022/06/25/linux/fedora/fedora%20%E5%AD%98%E5%82%A8%E5%BA%93/">Fedora 包管理器</a></p><p class="categories"><a href="/categories/Linux/">Linux</a> / <a href="/categories/Linux/Fedora/">Fedora</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-06-24T16:00:00.000Z">2022-06-25</time></p><p class="title"><a href="/2022/06/25/linux/fedora/feaora%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE/">Fedora 初始化配置</a></p><p class="categories"><a href="/categories/Linux/">Linux</a> / <a href="/categories/Linux/Fedora/">Fedora</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-29T07:46:22.000Z">2022-05-29</time></p><p class="title"><a href="/2022/05/29/linux/ubuntu/Ubuntu%20%E5%88%9D%E5%A7%8B%E5%8C%96%E9%85%8D%E7%BD%AE/">Ubuntu 初始化配置</a></p><p class="categories"><a href="/categories/Linux/">Linux</a> / <a href="/categories/Linux/Ubuntu/">Ubuntu</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-05-29T07:46:22.000Z">2022-05-29</time></p><p class="title"><a href="/2022/05/29/linux/ubuntu/Ubuntu%20%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8/">Ubuntu 包管理器</a></p><p class="categories"><a href="/categories/Linux/">Linux</a> / <a href="/categories/Linux/Ubuntu/">Ubuntu</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/09/"><span class="level-start"><span class="level-item">九月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">六月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">五月 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">一月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">十二月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">六月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">五月 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">四月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">三月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">十二月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">十月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/09/"><span class="level-start"><span class="level-item">九月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/08/"><span class="level-start"><span class="level-item">八月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/07/"><span class="level-start"><span class="level-item">七月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">六月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">五月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/03/"><span class="level-start"><span class="level-item">三月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">二月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Fedora/"><span class="tag">Fedora</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kubernetes/"><span class="tag">Kubernetes</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Redis/"><span class="tag">Redis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SpringBootWeb%E6%A1%86%E6%9E%B6%E9%9B%86%E6%88%90/"><span class="tag">SpringBootWeb框架集成</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SpringBoot%E6%95%B0%E6%8D%AE%E5%BA%93%E9%9B%86%E6%88%90/"><span class="tag">SpringBoot数据库集成</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SpringBoot%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD/"><span class="tag">SpringBoot核心功能</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SpringBoot%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"><span class="tag">SpringBoot源码解析</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Spring%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE/"><span class="tag">Spring数据访问</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Spring%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD/"><span class="tag">Spring核心功能</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Spring%E6%B3%A8%E8%A7%A3/"><span class="tag">Spring注解</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ubuntu/"><span class="tag">Ubuntu</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/fedora/"><span class="tag">fedora</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8/"><span class="tag">包管理器</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%88%AC%E8%99%AB/"><span class="tag">爬虫</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"><span class="tag">环境配置</span><span class="tag">2</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/avatar.png" alt="路由器" height="28"></a><p class="is-size-7"><span>&copy; 2022 路由器</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>